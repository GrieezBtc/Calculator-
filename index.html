<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Advanced Calculator & Live Converter</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            padding: 20px;
            transition: background 0.3s ease;
        }
        
        body.dark-mode {
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
        }
        
        .container { width: 100%; max-width: 450px; }
        
        .calculator {
            width: 100%;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .calculator.dark {
            background: rgba(30, 30, 40, 0.95);
            color: #ecf0f1;
        }
        
        .calculator-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .calculator-title { font-size: 24px; font-weight: 300; color: #333; }
        .calculator.dark .calculator-title { color: #ecf0f1; }
        
        .top-controls { display: flex; gap: 10px; }
        
        .mode-toggle-btn, .theme-toggle-btn {
            width: 40px; height: 40px; border: none; border-radius: 8px;
            cursor: pointer; display: flex; align-items: center;
            justify-content: center; font-size: 18px; background: #f0f0f0;
            transition: all 0.3s ease;
        }
        
        .calculator.dark .mode-toggle-btn, .calculator.dark .theme-toggle-btn {
            background: #34495e; color: #ecf0f1;
        }
        
        .mode-toggle-btn.active { background: #007aff; color: white; }
        
        .display-container { position: relative; margin-bottom: 20px; }
        
        .calculator input[type="text"] {
            width: 100%; height: 100px; font-size: 36px; padding: 20px;
            margin-bottom: 10px; border: 2px solid #ddd; border-radius: 15px;
            text-align: right; background: #f8f9fa; color: #333;
        }
        
        .calculator.dark input[type="text"] {
            background: #2c3e50; color: #ecf0f1; border-color: #34495e;
        }

        .preview {
            position: absolute; right: 20px; top: 10px;
            font-size: 18px; color: #666; opacity: 0.7;
        }

        /* Grids */
        .buttons-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
        .scientific-buttons { display: none; grid-template-columns: repeat(5, 1fr); gap: 10px; margin-bottom: 15px; }
        .scientific-mode .scientific-buttons { display: grid; }
        
        .converter-panel { display: none; margin-bottom: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px; }
        .converter-mode .converter-panel { display: block; }
        .calculator.dark .converter-panel { background: #2c3e50; }

        .converter-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
        .converter-grid select, .converter-grid input { padding: 10px; border-radius: 8px; border: 1px solid #ccc; }

        /* Buttons */
        button { cursor: pointer; font-weight: 600; border-radius: 12px; border: none; transition: 0.2s; }
        .number { background: #e9ecef; }
        .operator { background: #ff9500; color: white; }
        .equals { background: #007aff; color: white; }
        .function { background: #a6a6a6; color: white; }
        .zero { grid-column: span 2; height: 60px; }
        .calculator button { height: 60px; }
        
        .history-panel { margin-top: 15px; background: rgba(255,255,255,0.8); border-radius: 15px; padding: 10px; max-height: 150px; overflow-y: auto; }
        body.dark-mode .history-panel { background: rgba(0,0,0,0.3); color: white; }
    </style>
</head>
<body>
    <div class="container">
        <div class="calculator" id="calculator">
            <div class="calculator-header">
                <h1 class="calculator-title">Pro Calc</h1>
                <div class="top-controls">
                    <button class="theme-toggle-btn" onclick="toggleTheme()">üåô</button>
                    <button id="mode-basic" class="mode-toggle-btn active" onclick="setMode('basic')">üßÆ</button>
                    <button id="mode-scientific" class="mode-toggle-btn" onclick="setMode('scientific')">üî¨</button>
                    <button id="mode-converter" class="mode-toggle-btn" onclick="setMode('converter')">üîÑ</button>
                </div>
            </div>
            
            <div class="display-container">
                <input type="text" id="display" readonly placeholder="0">
                <div class="preview" id="preview"></div>
            </div>
            
            <div class="scientific-buttons">
                <button class="operator" onclick="addMath('Math.sqrt(')">‚àö</button>
                <button class="operator" onclick="addMath('Math.pow(')">x‚Åø</button>
                <button class="operator" onclick="addMath('Math.sin(')">sin</button>
                <button class="operator" onclick="addMath('Math.cos(')">cos</button>
                <button class="operator" onclick="addMath('Math.PI')">œÄ</button>
            </div>
            
            <div class="converter-panel">
                <div class="converter-grid">
                    <select id="convType" onchange="updateUnits()">
                        <option value="currency">Currency (Live NGN)</option>
                        <option value="length">Length</option>
                    </select>
                    <input type="number" id="convInput" value="1" oninput="doConvert()">
                    <select id="convFrom" onchange="doConvert()"></select>
                    <select id="convTo" onchange="doConvert()"></select>
                </div>
                <div id="convRes" style="margin-top:10px; font-weight:bold; text-align:center;">Result appears here</div>
            </div>
            
            <div class="buttons-grid">
                <button class="function" onclick="clearDisplay()">C</button>
                <button class="function" onclick="deleteChar()">DEL</button>
                <button class="function" onclick="addChar('(')">(</button>
                <button class="operator" onclick="addChar('/')">/</button>
                <button class="number" onclick="addChar('7')">7</button>
                <button class="number" onclick="addChar('8')">8</button>
                <button class="number" onclick="addChar('9')">9</button>
                <button class="operator" onclick="addChar('*')">√ó</button>
                <button class="number" onclick="addChar('4')">4</button>
                <button class="number" onclick="addChar('5')">5</button>
                <button class="number" onclick="addChar('6')">6</button>
                <button class="operator" onclick="addChar('-')">-</button>
                <button class="number" onclick="addChar('1')">1</button>
                <button class="number" onclick="addChar('2')">2</button>
                <button class="number" onclick="addChar('3')">3</button>
                <button class="operator" onclick="addChar('+')">+</button>
                <button class="number zero" onclick="addChar('0')">0</button>
                <button class="number" onclick="addChar('.')">.</button>
                <button class="equals" onclick="calculate()">=</button>
            </div>
        </div>
        <div class="history-panel" id="history">History is empty</div>
    </div>

    <script>
        const display = document.getElementById('display');
        const preview = document.getElementById('preview');
        const calc = document.getElementById('calculator');
        let liveRates = { "NGN": 1, "USD": 0.00065, "GBP": 0.00052, "EUR": 0.00061 };

        // Fetch Live Rates (Free API - No Key Required for basic usage)
        async function fetchRates() {
            try {
                const res = await fetch('https://open.er-api.com/v6/latest/NGN');
                const data = await res.json();
                if(data.rates) {
                    liveRates = data.rates;
                    console.log("Rates updated live!");
                    if(document.getElementById('convType').value === 'currency') updateUnits();
                }
            } catch (e) { console.log("Using fallback rates."); }
        }
        fetchRates();

        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            calc.classList.toggle('dark');
        }

        function setMode(mode) {
            calc.className = 'calculator ' + (mode + '-mode') + (document.body.classList.contains('dark-mode') ? ' dark' : '');
            document.querySelectorAll('.mode-toggle-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('mode-' + mode).classList.add('active');
            if(mode === 'converter') updateUnits();
        }

        function addChar(c) { display.value += c; autoPreview(); }
        function addMath(m) { display.value += m; }
        function clearDisplay() { display.value = ''; preview.textContent = ''; }
        function deleteChar() { display.value = display.value.slice(0,-1); autoPreview(); }

        function autoPreview() {
            try { if(display.value) preview.textContent = eval(display.value); } catch(e) {}
        }

        function calculate() {
            try {
                let res = eval(display.value);
                document.getElementById('history').innerHTML = `<div>${display.value} = ${res}</div>` + document.getElementById('history').innerHTML;
                display.value = res;
                preview.textContent = '';
            } catch(e) { display.value = 'Error'; }
        }

        // Converter Logic
        const unitData = {
            length: { "Meters": 1, "KM": 0.001, "Miles": 0.00062, "Feet": 3.28 },
            currency: liveRates
        };

        function updateUnits() {
            const type = document.getElementById('convType').value;
            const data = type === 'currency' ? liveRates : unitData[type];
            const from = document.getElementById('convFrom');
            const to = document.getElementById('convTo');
            const options = Object.keys(data).map(k => `<option value="${k}">${k}</option>`).join('');
            from.innerHTML = to.innerHTML = options;
            doConvert();
        }

        function doConvert() {
            const type = document.getElementById('convType').value;
            const val = parseFloat(document.getElementById('convInput').value) || 0;
            const from = document.getElementById('convFrom').value;
            const to = document.getElementById('convTo').value;
            const data = type === 'currency' ? liveRates : unitData[type];
            
            const result = (val / data[from]) * data[to];
            document.getElementById('convRes').textContent = `${val} ${from} = ${result.toFixed(type==='currency'?2:4)} ${to}`;
        }
    </script>
</body>
                    </html>

