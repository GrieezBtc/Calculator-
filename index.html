<!DOCTYPE html>
<html lang="en">
<head>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-5K6R4795LV"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-5K6R4795LV');
  </script>
  
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0, viewport-fit=cover" />
  <title>Pro Calc & Vault</title>
  
  <script src="https://unpkg.com/dexie/dist/dexie.js"></script>

  <style>
    :root {
      --bg-body: #f0f2f5; --bg-calc: #ffffff; --bg-display: #f8f9fa;
      --text-main: #202124; --btn-bg: #f1f3f4; --accent: #fbaf00;
      --success: #34a853; --error: #ea4335;
    }
    [data-theme="dark"] {
      --bg-body: #121212; --bg-calc: #202124; --bg-display: #2d2e31;
      --text-main: #e8eaed; --btn-bg: #3c4043;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; font-family: -apple-system, sans-serif; outline: none; -webkit-tap-highlight-color: transparent; }
    body { background-color: var(--bg-body); height: 100dvh; display: flex; justify-content: center; align-items: center; overflow: hidden; transition: background 0.3s; }
    
    .app-container { width: 100%; max-width: 420px; height: 100%; background: var(--bg-calc); display: flex; flex-direction: column; padding: 15px; position: relative; transition: background 0.3s; overflow-y: auto; }
    @media (min-width: 420px) { .app-container { height: 90dvh; border-radius: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); } }

    .nav { display: flex; gap: 5px; margin-bottom: 10px; }
    .nav button { flex: 1; padding: 12px 5px; border: none; border-radius: 12px; background: var(--btn-bg); color: var(--text-main); font-weight: 600; cursor: pointer; font-size: 0.7rem; transition: transform 0.1s; }
    .nav button.active { background: var(--accent); color: white; }

    #screen { background: var(--bg-display); border-radius: 20px; padding: 20px; margin-bottom: 15px; display: flex; flex-direction: column; justify-content: flex-end; align-items: flex-end; min-height: 140px; }
    #live-preview { font-size: 1.1rem; color: #888; min-height: 1.4rem; margin-bottom: 5px; }
    #main-input { font-size: 2.5rem; color: var(--text-main); text-align: right; word-break: break-all; }

    .grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
    button.key { border: none; border-radius: 18px; background: var(--btn-bg); color: var(--text-main); font-size: 1.3rem; font-weight: 500; cursor: pointer; display: flex; justify-content: center; align-items: center; min-height: 60px; }
    .op { color: var(--accent); font-weight: 700; }
    .eq { background: var(--success) !important; color: white; grid-column: span 2; border-radius: 35px; }
    .clr { background: var(--error) !important; color: white; }

    #vault-mode, #conv-mode { display: none; flex-direction: column; padding: 10px; }
    .conv-box { background: var(--bg-display); padding: 20px; border-radius: 20px; text-align: center; margin-bottom: 15px; }
    input.amt { width: 100%; padding: 12px; border-radius: 12px; border: 1px solid #ddd; background: var(--bg-calc); color: var(--text-main); margin-bottom: 10px; }
    
    #vault-gallery img, #vault-gallery video { width: 100%; border-radius: 10px; margin-top: 10px; border: 1px solid #ddd; }
  </style>
</head>
<body>

<div class="app-container">
  <div class="nav">
    <button id="tab-calc" class="active" onclick="setMode('calc')">Calc</button>
    <button id="tab-conv" onclick="setMode('conv')">Currency</button>
    <button id="theme-icon" onclick="toggleTheme()">ðŸŒ™</button>
  </div>

  <div id="calc-mode">
    <div id="screen">
      <div id="live-preview"></div>
      <div id="main-input">0</div>
    </div>
    <div class="grid">
      <button class="key clr" onclick="cls()">C</button>
      <button class="key" onclick="del()">âŒ«</button>
      <button class="key op" onclick="press('%')">%</button>
      <button class="key op" onclick="press('/')">Ã·</button>
      <button class="key" onclick="press('7')">7</button>
      <button class="key" onclick="press('8')">8</button>
      <button class="key" onclick="press('9')">9</button>
      <button class="key op" onclick="press('*')">x</button>
      <button class="key" onclick="press('4')">4</button>
      <button class="key" onclick="press('5')">5</button>
      <button class="key" onclick="press('6')">6</button>
      <button class="key op" onclick="press('-')">-</button>
      <button class="key" onclick="press('1')">1</button>
      <button class="key" onclick="press('2')">2</button>
      <button class="key" onclick="press('3')">3</button>
      <button class="key op" onclick="press('+')">+</button>
      <button class="key" onclick="press('0')">0</button>
      <button class="key" onclick="press('.')">.</button>
      <button class="key eq" onclick="run()">=</button>
    </div>
  </div>

  <div id="conv-mode">
    <div class="conv-box">
      <input type="number" id="amt" class="amt" value="1" oninput="convert()">
      <h2 id="res" style="color:var(--accent); font-size:1.8rem;">0.00</h2>
      <p style="font-size: 0.8rem; color: #888;">Live Rates Applied</p>
    </div>
  </div>

  <div id="vault-mode">
    <div class="conv-box">
      <h2 style="color:var(--success)">ðŸ”’ Private Vault</h2>
      <input type="file" id="vault-input" class="amt" accept="image/*,video/*">
      <button class="key eq" style="width:100%; font-size:1rem; padding:10px;" onclick="saveToVault()">Secure Upload</button>
    </div>
    <div id="vault-gallery"></div>
    <button class="key clr" style="width:100%; margin-top:20px;" onclick="location.reload()">Lock Vault</button>
  </div>
</div>

<script>
  let currentInput = "0";
  const db = new Dexie("VaultDB");
  db.version(1).stores({ files: "++id, type" });

  function setMode(m) {
    document.getElementById('calc-mode').style.display = m === 'calc' ? 'block' : 'none';
    document.getElementById('conv-mode').style.display = m === 'conv' ? 'flex' : 'none';
    document.getElementById('vault-mode').style.display = 'none';
    document.getElementById('tab-calc').className = m === 'calc' ? 'active' : '';
    document.getElementById('tab-conv').className = m === 'conv' ? 'active' : '';
  }

  function press(v) { 
    if(currentInput === "0" && !isNaN(v)) currentInput = v; 
    else currentInput += v; 
    update(); 
  }

  function cls() { currentInput = "0"; update(); }
  function del() { currentInput = currentInput.length > 1 ? currentInput.slice(0, -1) : "0"; update(); }

  function update() {
    document.getElementById('main-input').innerText = currentInput;
  }

  function run() {
    // SECRET TRIGGER: Type 1234 and hit =
    if (currentInput === "1234") {
      document.getElementById('calc-mode').style.display = 'none';
      document.getElementById('vault-mode').style.display = 'flex';
      renderVault();
      return;
    }
    try {
      currentInput = eval(currentInput).toString();
      update();
    } catch { currentInput = "Error"; update(); }
  }

  // GIGABYTE VAULT LOGIC
  async function saveToVault() {
    const file = document.getElementById('vault-input').files[0];
    if (!file) return;
    await db.files.add({ type: file.type, data: file });
    renderVault();
  }

  async function renderVault() {
    const gallery = document.getElementById('vault-gallery');
    gallery.innerHTML = "";
    const items = await db.files.toArray();
    items.forEach(item => {
      const url = URL.createObjectURL(item.data);
      const el = item.type.startsWith('image/') ? document.createElement('img') : document.createElement('video');
      el.src = url; if(!item.type.startsWith('image/')) el.controls = true;
      gallery.appendChild(el);
    });
  }

  function toggleTheme() {
    const current = document.body.getAttribute('data-theme');
    document.body.setAttribute('data-theme', current === 'dark' ? 'light' : 'dark');
  }
</script>
</body>
</html>
